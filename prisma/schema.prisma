generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model UserSettings {
  id              String   @id @default(cuid())
  defaultLocation String   @default("Balbriggan, IE")
  latitude        Float    @default(53.6108)
  longitude       Float    @default(-6.1817)
  raceDate        DateTime @default(dbgenerated("'2026-05-17 10:00:00'::timestamp without time zone"))
  raceName        String   @default("Life Style Sports Fastlane Summer Edition 2026")
  targetTime      String   @default("2:00:00")
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model WeatherCache {
  id            String   @id @default(cuid())
  location      String
  latitude      Float
  longitude     Float
  datetime      DateTime
  condition     String
  description   String
  temperature   Float
  feelsLike     Float
  precipitation Float
  humidity      Int
  windSpeed     Float
  windDirection Int
  cachedAt      DateTime @default(now())
  expiresAt     DateTime
  timezone      String   @default("Europe/Dublin")

  @@unique([location, datetime])
  @@index([location, datetime])
  @@index([expiresAt])
}

model TrainingPlan {
  id                  String   @id @default(cuid())
  phase               Phase
  weekNumber          Int      @unique
  weekStart           DateTime
  weekEnd             DateTime
  longRunTarget       Float
  weeklyMileageTarget Float
  notes               String?
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  @@index([weekStart])
}

model WeatherPreference {
  id               String   @id @default(cuid())
  runType          RunType  @unique
  maxPrecipitation Float
  maxWindSpeed     Float?
  minTemperature   Float?
  maxTemperature   Float?
  avoidConditions  String[]
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model Run {
  id        String   @id @default(cuid())
  date      DateTime @unique
  distance  Float
  pace      String
  duration  String
  type      RunType
  notes     String?
  completed Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([date])
  @@index([completed])
}

enum RunType {
  LONG_RUN
  EASY_RUN
  TEMPO_RUN
  INTERVAL_RUN
  RECOVERY_RUN
  RACE
}

enum Phase {
  BASE_BUILDING
  BASE_EXTENSION
  SPEED_DEVELOPMENT
  PEAK_TAPER
}

model Recommendation {
  id          String                 @id @default(cuid())
  title       String
  description String
  category    RecommendationCategory
  phase       Phase?
  priority    RecommendationPriority @default(MEDIUM)
  source      String?
  createdAt   DateTime               @default(now())
  updatedAt   DateTime               @updatedAt

  @@index([phase])
  @@index([category])
}

enum RecommendationCategory {
  INJURY_PREVENTION
  NUTRITION
  PACING
  RECOVERY
  GEAR
  MENTAL
}

enum RecommendationPriority {
  HIGH
  MEDIUM
  LOW
}
